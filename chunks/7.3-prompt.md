# Chunk 7.3 — LiteCMS Design System as .pen File

## Goal

Create a `.pen` design system file containing 8 reusable visual components (hero, text section, feature grid, CTA, image+text, testimonials, FAQ, footer) with design token variables supporting light/dark themes. This file is a component library — not a rendered page — that AI and the Pencil editor use to generate visual pages via `ref` instances.

## Context Files

- `PROMPT.md` — Full project specification
- `CHUNK-7.3-PLAN.md` — Detailed reference with complete JSON structures (consult if stuck)
- `app/PageBuilder/PenConverter.php` — Converter that processes `.pen` files into HTML/CSS
- `app/PageBuilder/PenStyleBuilder.php` — Resolves `$--variable` references to `var(--variable)`
- `app/PageBuilder/PenNodeRenderer.php` — Infers semantic HTML tags from frame `name` values
- `tests/chunk-7.3-verify.php` — Automated tests you MUST pass before declaring done

## Files to Create (in dependency order)

| # | File | Purpose |
|---|------|---------|
| 1 | `designs/litecms-system.pen` | Design system JSON — 8 reusable components + variables |
| 2 | `designs/README.md` | Documents components, variables, slot IDs, and usage |
| 3 | `tests/chunk-7.3-verify.php` | Automated verification (20 tests) |

No PHP application code changes in this chunk.

## Document Structure

```json
{
  "version": "2.7",
  "variables": { /* 17 design tokens */ },
  "children": [
    { "id": "hero-section", "reusable": true, ... },
    { "id": "text-section", "reusable": true, ... },
    { "id": "feature-grid", "reusable": true, ... },
    { "id": "cta-banner", "reusable": true, ... },
    { "id": "image-text", "reusable": true, ... },
    { "id": "testimonial-section", "reusable": true, ... },
    { "id": "faq-section", "reusable": true, ... },
    { "id": "footer-section", "reusable": true, ... }
  ]
}
```

## Component Summary

| # | Component | ID | Key Slots | Background |
|---|---|---|---|---|
| 1 | Hero Section | `hero-section` | `hero-heading`, `hero-subheading`, `hero-cta-text` | `$--primary` |
| 2 | Text Section | `text-section` | `text-heading`, `text-body` | `$--background` |
| 3 | Feature Grid | `feature-grid` | `feat-heading`, `feat-card-{1-3}-title`, `feat-card-{1-3}-desc` | `$--muted` |
| 4 | CTA Banner | `cta-banner` | `cta-heading`, `cta-body`, `cta-button-text` | `$--primary` |
| 5 | Image + Text | `image-text` | `imgtext-heading`, `imgtext-body`, `imgtext-image` | `$--background` |
| 6 | Testimonials | `testimonial-section` | `testi-heading`, `testi-card-{1-3}-quote/author/role` | `$--background` |
| 7 | FAQ Section | `faq-section` | `faq-heading`, `faq-item-{1-3}-q/a` | `$--muted` |
| 8 | Footer | `footer-section` | `footer-copyright`, `footer-link-{1-3}`, `footer-social-label` | `$--foreground` |

## Variable Definitions

17 design tokens. Color variables use themed array format for light/dark:

**Colors (themed):** `primary`, `primary-foreground`, `background`, `foreground`, `muted`, `muted-foreground`, `card`, `card-foreground`, `border`, `accent`
- Light/dark format: `{"type":"color","value":[{"value":"#hex","theme":{}},{"value":"#hex","theme":{"mode":"dark"}}]}`

**Typography:** `font-primary`, `font-secondary` — `"Inter, system-ui, sans-serif"`

**Spacing/Sizing:** `radius-m` (8), `radius-pill` (9999), `spacing-section` (80), `spacing-content` (40), `max-width` (1200)

See `CHUNK-7.3-PLAN.md` for exact hex values.

## Key Constraints

- All components: `"type": "frame"`, `"reusable": true`, `"width": "fill_container"`
- All colors/fonts reference variables: `"$--primary"`, `"$--font-primary"`, etc.
- PenStyleBuilder resolves `$--name` → `var(--name)` in CSS output
- Child node `id` values are slot identifiers used in `descendants` overrides
- Frame `name` values drive semantic HTML: "Footer" → `<footer>`, "Section" → `<section>`
- Text `fontSize` drives heading tags: >=32 → `<h1>`, >=24 → `<h2>`, >=20 → `<h3>`
- Components must render cleanly via PenConverter when used as `ref` instances
- No external images or fonts — placeholders use colored frames with text labels
- Variable key is `"primary"` (no `--`); PenConverter prepends `--` in CSS output
- The design system file alone produces empty HTML (all children are reusable templates)

## Verification

After implementation, run:
```
php tests/chunk-7.3-verify.php
```

All 20 tests must show `[PASS]`. Fix any `[FAIL]` before declaring this chunk complete.

Smoke test (tests 1-5 only):
```
LITECMS_TEST_SMOKE=1 php tests/chunk-7.3-verify.php
```

Full regression:
```
php tests/run-all.php --full
```

## Reference

For complete component JSON structures, variable hex values, test script template, and README content guide, see `CHUNK-7.3-PLAN.md`.
